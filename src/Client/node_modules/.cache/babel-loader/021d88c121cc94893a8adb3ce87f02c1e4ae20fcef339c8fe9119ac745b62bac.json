{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import ReactCardFlip from\"react-card-flip\";import{AnimatePresence,motion}from\"framer-motion\";import socket from\"../../socket\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PhaseResult=_ref=>{let{votes,setShowResultScreen,roomSessionKey,playerSessionKey,show// boolean to control visibility\n}=_ref;const[flippedCards,setFlippedCards]=useState([]);const[currentFlipping,setCurrentFlipping]=useState(-1);useEffect(()=>{if(!votes||!show)return;const cards=[];for(let i=0;i<votes.success;i++)cards.push({id:i,type:\"success\"});for(let i=0;i<votes.fail;i++)cards.push({id:votes.success+i,type:\"fail\"});const shuffled=cards;// Start all cards blinking immediately\nsetCurrentFlipping(-2);// Special value to make all cards blink\nshuffled.forEach((card,index)=>{setTimeout(()=>{setFlippedCards(prev=>[...prev,card.id]);if(index===shuffled.length-1){setCurrentFlipping(-1);// Emit next_phase after all cards are shown\nsetTimeout(()=>{socket.emit(\"next_phase\",{roomSessionKey,playerSessionKey});setShowResultScreen(false);},3000);}},index===shuffled.length-1?index*1500+5000+4000:index*1500+4000// 4 seconds of blinking\n);});setFlippedCards([]);return()=>{// Cleanup handled by individual timeouts\n};},[votes,show,playerSessionKey,roomSessionKey,setShowResultScreen]);if(!votes)return null;const cards=[];for(let i=0;i<votes.success;i++)cards.push({id:i,type:\"success\"});for(let i=0;i<votes.fail;i++)cards.push({id:votes.success+i,type:\"fail\"});const shuffled=cards;return/*#__PURE__*/_jsx(AnimatePresence,{children:show&&/*#__PURE__*/_jsx(motion.div,{className:\"fixed inset-0 bg-black bg-opacity-100 flex items-center justify-center z-50\",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:0.2},children:/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-4\",children:shuffled.map(card=>/*#__PURE__*/_jsxs(ReactCardFlip,{isFlipped:flippedCards.includes(card.id),flipDirection:\"horizontal\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-48 h-72 bg-purple-700 rounded-lg flex items-center justify-center text-white text-6xl font-bold \".concat(currentFlipping===-2||currentFlipping===shuffled.findIndex(c=>c.id===card.id)?\"animate-pulse\":\"\"),children:\"?\"}),/*#__PURE__*/_jsx(\"div\",{className:\"w-48 h-72 rounded-lg flex items-center justify-center text-white text-6xl font-bold \".concat(card.type===\"success\"?\"bg-amber-600\":\"bg-red-600\"),children:card.type===\"success\"?\"✓\":\"✗\"})]},card.id))})})});};export default PhaseResult;","map":{"version":3,"names":["React","useState","useEffect","ReactCardFlip","AnimatePresence","motion","socket","jsx","_jsx","jsxs","_jsxs","PhaseResult","_ref","votes","setShowResultScreen","roomSessionKey","playerSessionKey","show","flippedCards","setFlippedCards","currentFlipping","setCurrentFlipping","cards","i","success","push","id","type","fail","shuffled","forEach","card","index","setTimeout","prev","length","emit","children","div","className","initial","opacity","animate","exit","transition","duration","map","isFlipped","includes","flipDirection","concat","findIndex","c"],"sources":["C:/Users/ntalg/Documents/NTALLAS_GEORGIOS_DOCUMENTS/PROJECTS/Sabotage/Sabotage/src/client/src/components/ui/PhaseResult.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport ReactCardFlip from \"react-card-flip\";\r\nimport { AnimatePresence, motion } from \"framer-motion\";\r\nimport socket from \"../../socket\";\r\n\r\nconst PhaseResult = ({\r\n  votes,\r\n  setShowResultScreen,\r\n  roomSessionKey,\r\n  playerSessionKey,\r\n  show, // boolean to control visibility\r\n}) => {\r\n  const [flippedCards, setFlippedCards] = useState([]);\r\n  const [currentFlipping, setCurrentFlipping] = useState(-1);\r\n\r\n  useEffect(() => {\r\n    if (!votes || !show) return;\r\n\r\n    const cards = [];\r\n\r\n    for (let i = 0; i < votes.success; i++)\r\n      cards.push({ id: i, type: \"success\" });\r\n    for (let i = 0; i < votes.fail; i++)\r\n      cards.push({ id: votes.success + i, type: \"fail\" });\r\n\r\n    const shuffled = cards;\r\n\r\n    // Start all cards blinking immediately\r\n    setCurrentFlipping(-2); // Special value to make all cards blink\r\n\r\n    shuffled.forEach((card, index) => {\r\n      setTimeout(\r\n        () => {\r\n          setFlippedCards((prev) => [...prev, card.id]);\r\n          if (index === shuffled.length - 1) {\r\n            setCurrentFlipping(-1);\r\n            // Emit next_phase after all cards are shown\r\n            setTimeout(() => {\r\n              socket.emit(\"next_phase\", { roomSessionKey, playerSessionKey });\r\n              setShowResultScreen(false);\r\n            }, 3000);\r\n          }\r\n        },\r\n        index === shuffled.length - 1\r\n          ? index * 1500 + 5000 + 4000\r\n          : index * 1500 + 4000 // 4 seconds of blinking\r\n      );\r\n    });\r\n\r\n    setFlippedCards([]);\r\n\r\n    return () => {\r\n      // Cleanup handled by individual timeouts\r\n    };\r\n  }, [votes, show, playerSessionKey, roomSessionKey, setShowResultScreen]);\r\n\r\n  if (!votes) return null;\r\n\r\n  const cards = [];\r\n  for (let i = 0; i < votes.success; i++)\r\n    cards.push({ id: i, type: \"success\" });\r\n  for (let i = 0; i < votes.fail; i++)\r\n    cards.push({ id: votes.success + i, type: \"fail\" });\r\n  const shuffled = cards;\r\n\r\n  return (\r\n    <AnimatePresence>\r\n      {show && (\r\n        <motion.div\r\n          className=\"fixed inset-0 bg-black bg-opacity-100 flex items-center justify-center z-50\"\r\n          initial={{ opacity: 0 }}\r\n          animate={{ opacity: 1 }}\r\n          exit={{ opacity: 0 }}\r\n          transition={{ duration: 0.2 }}\r\n        >\r\n          <div className=\"flex gap-4\">\r\n            {shuffled.map((card) => (\r\n              <ReactCardFlip\r\n                key={card.id}\r\n                isFlipped={flippedCards.includes(card.id)}\r\n                flipDirection=\"horizontal\"\r\n              >\r\n                <div\r\n                  className={`w-48 h-72 bg-purple-700 rounded-lg flex items-center justify-center text-white text-6xl font-bold ${\r\n                    currentFlipping === -2 ||\r\n                    currentFlipping ===\r\n                      shuffled.findIndex((c) => c.id === card.id)\r\n                      ? \"animate-pulse\"\r\n                      : \"\"\r\n                  }`}\r\n                >\r\n                  ?\r\n                </div>\r\n                <div\r\n                  className={`w-48 h-72 rounded-lg flex items-center justify-center text-white text-6xl font-bold ${\r\n                    card.type === \"success\" ? \"bg-amber-600\" : \"bg-red-600\"\r\n                  }`}\r\n                >\r\n                  {card.type === \"success\" ? \"✓\" : \"✗\"}\r\n                </div>\r\n              </ReactCardFlip>\r\n            ))}\r\n          </div>\r\n        </motion.div>\r\n      )}\r\n    </AnimatePresence>\r\n  );\r\n};\r\n\r\nexport default PhaseResult;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}